{
  "mcpServers": {
    "abuseipdb-docker": {
      "command": "docker",
      "args": [
        "run",
        "--rm",
        "-i",
        "--name", "abuseipdb-mcp-client",
        "-e", "ABUSEIPDB_API_KEY",
        "abuseipdb-mcp-server"
      ],
      "description": "AbuseIPDB API integration running in Docker container",
      "version": "1.0.0",
      "author": "AbuseIPDB MCP Server",
      "homepage": "https://github.com/your-repo/abuseipdb-mcp-server",
      "license": "MIT",
      "transport": {
        "type": "stdio",
        "description": "Communication via stdin/stdout with Docker container"
      },
      "env": {
        "ABUSEIPDB_API_KEY": "your_api_key_here"
      },
      "capabilities": {
        "tools": [
          {
            "name": "check_ip",
            "description": "Check an IP address for abuse reports using AbuseIPDB",
            "parameters": {
              "type": "object",
              "properties": {
                "ipAddress": {
                  "type": "string",
                  "description": "A valid IPv4 or IPv6 address to check",
                  "pattern": "^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$|^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^::1$|^::$"
                },
                "maxAgeInDays": {
                  "type": "integer",
                  "description": "Only return reports within the last x days (1-365)",
                  "minimum": 1,
                  "maximum": 365,
                  "default": 30
                },
                "verbose": {
                  "type": "boolean",
                  "description": "Include detailed reports in the response",
                  "default": false
                }
              },
              "required": ["ipAddress"]
            },
            "examples": [
              {
                "description": "Check a suspicious IP with verbose output",
                "parameters": {
                  "ipAddress": "118.25.6.39",
                  "maxAgeInDays": 90,
                  "verbose": true
                }
              },
              {
                "description": "Quick check of an IP address",
                "parameters": {
                  "ipAddress": "192.168.1.100"
                }
              }
            ]
          },
          {
            "name": "report_ip",
            "description": "Report an abusive IP address to AbuseIPDB",
            "parameters": {
              "type": "object",
              "properties": {
                "ip": {
                  "type": "string",
                  "description": "A valid IPv4 or IPv6 address to report",
                  "pattern": "^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$|^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^::1$|^::$"
                },
                "categories": {
                  "type": "string",
                  "description": "Comma separated category IDs (e.g., '18,22'). Common categories: 18=Brute Force, 22=SSH, 21=FTP Brute Force, 11=Comment Spam, 10=Email Spam, 5=Mail Server, 6=Hacking, 15=Port Scan",
                  "pattern": "^\\d+(,\\d+)*$"
                },
                "comment": {
                  "type": "string",
                  "description": "Descriptive text of the attack (no PII). Example: 'SSH login attempts with user root'",
                  "maxLength": 1024
                },
                "timestamp": {
                  "type": "string",
                  "description": "ISO 8601 datetime of the attack (optional). Example: '2023-10-18T11:25:11-04:00'",
                  "format": "date-time"
                }
              },
              "required": ["ip", "categories"]
            },
            "examples": [
              {
                "description": "Report SSH brute force attack",
                "parameters": {
                  "ip": "192.168.1.100",
                  "categories": "18,22",
                  "comment": "SSH brute force attempts detected",
                  "timestamp": "2023-10-18T11:25:11-04:00"
                }
              },
              {
                "description": "Report email spam",
                "parameters": {
                  "ip": "203.0.113.1",
                  "categories": "10",
                  "comment": "Sending spam emails to multiple recipients"
                }
              }
            ]
          }
        ]
      },
      "docker": {
        "image": "abuseipdb-mcp-server:latest",
        "registry": "your-registry.com/abuseipdb-mcp-server",
        "buildContext": ".",
        "dockerfile": "Dockerfile",
        "healthCheck": {
          "enabled": true,
          "interval": "30s",
          "timeout": "3s",
          "retries": 3
        },
        "resources": {
          "memory": "128m",
          "cpus": "0.5"
        },
        "networks": ["mcp-network"],
        "volumes": {
          "logs": "./logs:/app/logs"
        }
      },
      "deployment": {
        "local": {
          "command": "docker",
          "args": [
            "run", "--rm", "-i",
            "--name", "abuseipdb-mcp-local",
            "-e", "ABUSEIPDB_API_KEY",
            "abuseipdb-mcp-server:latest"
          ]
        },
        "compose": {
          "command": "docker-compose",
          "args": [
            "run", "--rm",
            "abuseipdb-mcp"
          ],
          "workingDirectory": ".",
          "envFile": ".env"
        },
        "kubernetes": {
          "namespace": "mcp-servers",
          "deployment": "abuseipdb-mcp-deployment",
          "service": "abuseipdb-mcp-service",
          "configMap": "abuseipdb-config",
          "secret": "abuseipdb-secret"
        }
      },
      "rateLimits": {
        "description": "AbuseIPDB API rate limits vary by subscription tier",
        "limits": {
          "standard": {
            "check": "1,000 requests/day",
            "report": "1,000 requests/day"
          },
          "webmaster": {
            "check": "3,000 requests/day",
            "report": "3,000 requests/day"
          },
          "supporter": {
            "check": "5,000 requests/day",
            "report": "1,000 requests/day"
          },
          "basic_subscription": {
            "check": "10,000 requests/day",
            "report": "10,000 requests/day"
          },
          "premium_subscription": {
            "check": "50,000 requests/day",
            "report": "50,000 requests/day"
          }
        }
      },
      "documentation": {
        "usage": "This MCP server provides integration with the AbuseIPDB API for checking IP reputation and reporting malicious IPs, running in a Docker container.",
        "setup": [
          "1. Get an API key from https://www.abuseipdb.com/api",
          "2. Build the Docker image: docker build -t abuseipdb-mcp-server .",
          "3. Set the ABUSEIPDB_API_KEY environment variable",
          "4. Configure your MCP client to use the Docker command"
        ],
        "security": "⚠️ Important: Strip any personally identifiable information (PII) from comments when reporting IPs.",
        "docker": {
          "prerequisites": [
            "Docker installed and running",
            "Image built: abuseipdb-mcp-server:latest",
            "API key configured in environment"
          ],
          "troubleshooting": {
            "container_not_starting": "Check if API key is set: echo $ABUSEIPDB_API_KEY",
            "permission_denied": "Ensure Docker daemon is running and user has permissions",
            "image_not_found": "Build the image first: docker build -t abuseipdb-mcp-server ."
          }
        },
        "categories": {
          "3": "Fraud Orders",
          "4": "DDoS Attack",
          "5": "FTP Brute-Force",
          "6": "Ping of Death",
          "7": "Phishing",
          "8": "Fraud VoIP",
          "9": "Open Proxy",
          "10": "Web Spam",
          "11": "Email Spam",
          "12": "Blog Spam",
          "13": "VPN IP",
          "14": "Port Scan",
          "15": "Hacking",
          "16": "SQL Injection",
          "17": "Spoofing",
          "18": "Brute-Force",
          "19": "Bad Web Bot",
          "20": "Exploited Host",
          "21": "Web App Attack",
          "22": "SSH",
          "23": "IoT Targeted"
        }
      }
    }
  }
} 